clc;
clear;
close all;

%% Problem Definition

% problem.CostFunction = @(x) Sphere(x);
% problem.nVar = 30;
% problem.VarMin = [-100];
% problem.VarMax = [ 100];

% problem.CostFunction = @(x) 5000/(((x(3)*(x(2)-2*x(4))^3)/12)+((x(1)*(x(4))^3)/6)+2*x(1)*x(4)*((x(2)-x(4))/2)^2);
%  
% problem.nVar = 4;
% problem.VarMin = [10 10 0.9 0.9];
% problem.VarMax = [50  80 5  5];

g = @(x,y)0.5+(((sin(sqrt(x.^2+y.^2)).^2)-0.5)/(1+(0.001*(x.^2+y.^2))).^2);

%Dla 30 ------------------------------------------------------------------------------------------------------------------------------------------------------
% problem.CostFunction = @(x) g(x(1), x(2))+g(x(2), x(3))+g(x(3), x(4))+g(x(4), x(5))+g(x(5), x(6))+g(x(6), x(7))+g(x(7), x(8))+g(x(8), x(9))+g(x(9), ...
    x(10))+g(x(10), x(11))+g(x(11), x(12))+g(x(12), x(13))+g(x(13), x(14))+g(x(14), x(15))+g(x(15), x(16))+g(x(16), x(17))+g(x(17), ...
    x(18))+g(x(18), x(19))+g(x(19), x(20))+g(x(20), x(21))+g(x(21), x(22))+g(x(22), x(23))+g(x(23), x(24))+g(x(24), x(25))+g(x(25), x(26))+g(x(26), x(27))+g(x(27), ...
    x(28))+g(x(28), x(29))+g(x(29), x(30))+g(x(30), x(1))
problem.nVar = 30;
%Dla 50 ------------------------------------------------------------------------------------------------------------------------------------------------------
% problem.CostFunction = @(x)g(x(1), x(2))+g(x(2), x(3))+g(x(3), x(4))+g(x(4), x(5))+g(x(5), x(6))+g(x(6), x(7))+g(x(7), x(8))+g(x(8), x(9))+g(x(9), ...
%     x(10))+g(x(10), x(11))+g(x(11), x(12))+g(x(12), x(13))+g(x(13), x(14))+g(x(14), x(15))+g(x(15), x(16))+g(x(16), x(17))+g(x(17), ...
%     x(18))+g(x(18), x(19))+g(x(19), x(20))+g(x(20), x(21))+g(x(21), x(22))+g(x(22), x(23))+g(x(23), x(24))+g(x(24), x(25))+g(x(25), x(26))+g(x(26), x(27))+g(x(27), ...
%     x(28))+g(x(28), x(29))+g(x(29), x(30))+g(x(30), x(31))+g(x(31), x(32))+g(x(32), x(33))+g(x(33), x(34))+g(x(34), x(35))+g(x(35), x(36))+g(x(36), x(37))+g(x(37), ...
%     x(38))+g(x(38), x(39))+g(x(39), x(40))+g(x(40), x(41))+g(x(41), x(42))+g(x(42), x(43))+g(x(43), x(44))+g(x(44), x(45))+g(x(45), x(46))+g(x(46), x(47))+g(x(47), ...
%     x(48))+g(x(48), x(49))+g(x(49), x(50))+g(x(50), x(1))
% problem.nVar = 50;
%Dla 100 ------------------------------------------------------------------------------------------------------------------------------------------------------
problem.CostFunction = @(x)g(x(1), x(2))+g(x(2), x(3))+g(x(3), x(4))+g(x(4), x(5))+g(x(5), x(6))+g(x(6), x(7))+g(x(7), x(8))+g(x(8), x(9))+g(x(9), ...
    x(10))+g(x(10), x(11))+g(x(11), x(12))+g(x(12), x(13))+g(x(13), x(14))+g(x(14), x(15))+g(x(15), x(16))+g(x(16), x(17))+g(x(17), ...
    x(18))+g(x(18), x(19))+g(x(19), x(20))+g(x(20), x(21))+g(x(21), x(22))+g(x(22), x(23))+g(x(23), x(24))+g(x(24), x(25))+g(x(25), x(26))+g(x(26), ...
    x(27))+g(x(27), x(28))+g(x(28), x(29))+g(x(29), x(30))+g(x(30), x(31))+g(x(31), x(32))+g(x(32), x(33))+g(x(33), x(34))+g(x(34), x(35))+g(x(35), ...
    x(36))+g(x(36), x(37))+g(x(37), x(38))+g(x(38), x(39))+g(x(39), x(40))+g(x(40), x(41))+g(x(41), x(42))+g(x(42), x(43))+g(x(43), x(44))+g(x(44), ...
    x(45))+g(x(45), x(46))+g(x(46), x(47))+g(x(47), x(48))+g(x(48), x(49))+g(x(49), x(50))+g(x(50), x(51))+g(x(51), x(52))+g(x(52), x(53))+g(x(53), ...
    x(54))+g(x(54), x(55))+g(x(55), x(56))+g(x(56), x(57))+g(x(57), x(58))+g(x(58), x(59))+g(x(59), x(60))+g(x(60), x(61))+g(x(61), x(62))+g(x(62), ...
    x(63))+g(x(63), x(64))+g(x(64), x(65))+g(x(65), x(66))+g(x(66), x(67))+g(x(67), x(68))+g(x(68), x(69))+g(x(69), x(70))+g(x(70), x(71))+g(x(71), ...
    x(72))+g(x(72), x(73))+g(x(73), x(74))+g(x(74), x(75))+g(x(75), x(76))+g(x(76), x(77))+g(x(77), x(78))+g(x(78), x(79))+g(x(79), x(80))+g(x(80), ...
    x(81))+g(x(81), x(82))+g(x(82), x(83))+g(x(83), x(84))+g(x(84), x(85))+g(x(85), x(86))+g(x(86), x(87))+g(x(87), x(88))+g(x(88), x(89))+g(x(89), ...
    x(90))+g(x(90), x(91))+g(x(91), x(92))+g(x(92), x(93))+g(x(93), x(94))+g(x(94), x(95))+g(x(95), x(96))+g(x(96), x(97))+g(x(97), x(98))+g(x(98), x(99))+g(x(99), x(100))+g(x(100), x(1))
problem.nVar = 100;
%----------------------------------------------------------------------------------------------------------------------------------------------------------------

problem.VarMin = [-100];
problem.VarMax = [100];

%% GA Parameters

params.MaxIt = 100;
params.nPop = 1000;

params.beta = 1;
params.pC = 1;
params.gamma = 0.1;
params.mu = 0.02;
params.sigma = 0.1;

%% Run GA

out = RunGA(problem, params);


%% Results

figure;
% plot(out.bestcost, 'LineWidth', 2);
semilogy(out.bestcost, 'LineWidth', 2);
xlabel('Iterations');
ylabel('Best Cost');
grid on;